let products = [
  {
    img: "https://8384f55340.vws.vegacdn.vn/image/cache/catalog/products/Autumn_2024/NEWBASKET_006.jpg.webp",
    name: "Bình Minh",
    sale: 0,
    newPrice: "1452500VND",
    oldPrice: "",
  },
  {
    img: "https://8384f55340.vws.vegacdn.vn/image/cache/catalog/products/Autumn_2024/NEWBASKET_008.jpg.webp",
    name: "Hạ Cuối",
    sale: 0,
    newPrice: "1752800VND",
    oldPrice: "",
  },
  {
    img: "https://8384f55340.vws.vegacdn.vn/image/cache/catalog/products/Autumn_2024/NEWBASKET_007.jpg.webp",
    name: "Nét Xinh",
    sale: 0,
    newPrice: "791000VND",
    oldPrice: "",
  },
  {
    img: "https://8384f55340.vws.vegacdn.vn/image/cache/catalog/products/Autumn_2024/NEWBOUQUET_071.jpg.webp",
    name: "Sweets",
    sale: 0,
    newPrice: "1645000VND",
    oldPrice: "",
  },
  {
    img: "https://8384f55340.vws.vegacdn.vn/image/cache/catalog/products/Autumn_2024/NEWBOUQUET_070.jpg.webp",
    name: "Highland Story",
    sale: 0,
    newPrice: "680000VND",
    oldPrice: "",
  },
  {
    img: "https://8384f55340.vws.vegacdn.vn/image/cache/catalog/products/Autumn_2024/NEWBOUQUET_069.jpg.webp",
    name: "Flower Field",
    sale: 0,
    newPrice: "650000VND",
    oldPrice: "",
  },
  {
    img: "https://8384f55340.vws.vegacdn.vn/image/cache/catalog/products/Autumn_2024/NEWBOUQUET_068.jpg.webp",
    name: "Cổ Tích",
    sale: 0,
    newPrice: "650000VND",
    oldPrice: "",
  },
  {
    img: "https://8384f55340.vws.vegacdn.vn/image/cache/catalog/products/Autumn_2024/NEWBOUQUET_067.jpg.webp",
    name: "Rainy Day",
    sale: 0,
    newPrice: "1990000VND",
    oldPrice: "",
  },
  {
    img: "https://8384f55340.vws.vegacdn.vn/image/cache/catalog/products/Autumn_2024/NEWBOUQUET_066.jpg.webp",
    name: "Just You",
    sale: 0,
    newPrice: "2000000VND",
    oldPrice: "",
  },
  {
    img: "https://8384f55340.vws.vegacdn.vn/image/cache/catalog/products/August%202022/lang-hoa-hong-cam-01.jpg.webp",
    name: "Sunrise Spirit",
    sale: 9,
    newPrice: "690000VND",
    oldPrice: "760000VND",
  },
  {
    img: "https://8384f55340.vws.vegacdn.vn/image/cache/catalog/products/Autumn_2024/NEWBOUQUET_064.jpg.webp",
    name: "DreamLand",
    sale: 0,
    newPrice: "1990000VND",
    oldPrice: "",
  },
  {
    img: "https://8384f55340.vws.vegacdn.vn/image/cache/catalog/products/Autumn_2024/NEWBOUQUET_063.jpg.webp",
    name: "Mỹ Miều",
    sale: 0,
    newPrice: "1100000VND",
    oldPrice: "",
  },
  {
    img: "https://8384f55340.vws.vegacdn.vn/image/cache/catalog/products/Autumn_2024/NEWBOUQUET_059.jpg.webp",
    name: "Thu Dịu Dàng",
    sale: 0,
    newPrice: "650000VND",
    oldPrice: "",
  },
  {
    img: "https://8384f55340.vws.vegacdn.vn/image/cache/catalog/products/August%202023/day-dreamer.jpg.webp",
    name: "Day Dreamer",
    sale: 0,
    newPrice: "650000VND",
    oldPrice: "",
  },
  {
    img: "https://8384f55340.vws.vegacdn.vn/image/cache/catalog/products/Autumn_2024/NEWBOUQUET_058.jpg.webp",
    name: "Nàng Thu",
    sale: 0,
    newPrice: "800000VND",
    oldPrice: "",
  },
  {
    img: "https://8384f55340.vws.vegacdn.vn/image/cache/catalog/products/Autumn_2024/NEWBOUQUET_055.jpg.webp",
    name: "Mưa Thu",
    sale: 0,
    newPrice: "480000VND",
    oldPrice: "",
  },
  {
    img: "https://8384f55340.vws.vegacdn.vn/image/cache/catalog/products/August%202023/bo-hoa-baby-mix-hong-kem.jpg.webp",
    name: "Endless Love",
    sale: 11,
    newPrice: "390000VND",
    oldPrice: "440000VND",
  },
  {
    img: "https://8384f55340.vws.vegacdn.vn/image/cache/catalog/products/August%202023/bo-hoa-hong-do-xuc-cam.jpg.webp",
    name: "Xúc Cảm",
    sale: 0,
    newPrice: "730000VND",
    oldPrice: "",
  },
  {
    img: "https://8384f55340.vws.vegacdn.vn/image/cache/catalog/products/August%202023/bo-hoa-ngo-loi.jpg.webp",
    name: "Ngỏ Lời",
    sale: 12,
    newPrice: "220000VND",
    oldPrice: "250000VND",
  },
  {
    img: "https://8384f55340.vws.vegacdn.vn/image/cache/catalog/products/Autumn_2024/NEWBOUQUET_062.jpg.webp",
    name: "Mưa Ngọt Ngào",
    sale: 0,
    newPrice: "754000VND",
    oldPrice: "",
  },
  {
    img: "https://8384f55340.vws.vegacdn.vn/image/cache/catalog/products/Autumn_2024/NEWBOUQUET_061.jpg.webp",
    name: "Kiêu Kỳ",
    sale: 0,
    newPrice: "839000VND",
    oldPrice: "",
  },
  {
    img: "https://8384f55340.vws.vegacdn.vn/image/cache/catalog/products/Autumn_2024/NEWBOUQUET_060.jpg.webp",
    name: "Lời Hứa",
    sale: 0,
    newPrice: "740000VND",
    oldPrice: "",
  },
  {
    img: "https://8384f55340.vws.vegacdn.vn/image/cache/catalog/products/Autumn_2024/NEWBOUQUET_057.jpg.webp",
    name: "Êm Đềm Thương",
    sale: 0,
    newPrice: "880000VND",
    oldPrice: "",
  },
  {
    img: "https://8384f55340.vws.vegacdn.vn/image/cache/catalog/products/August%202022/van-su-hong-phat.jpg.webp",
    name: "Rực Rỡ Sắc",
    sale: 0,
    newPrice: "1,217,500VND",
    oldPrice: "",
  },
];

let currentPage = 1;
let itemsPerPage = 8; // Số sản phẩm mỗi trang
let totalPages = Math.ceil(products.length / itemsPerPage);

function renderPagination() {
    let paginationHTML = '';

    for (let i = 1; i <= totalPages; i++) {
        paginationHTML += `
            <a href="#" onclick="goToPage(${i})" class="${i === currentPage ? 'active' : ''}">${i}</a>
        `;
    }

    paginationHTML += `
        <a href="#" onclick="goToPage(${currentPage + 1 <= totalPages ? currentPage + 1 : totalPages})">></a>
        <a href="#" onclick="goToPage(${totalPages})">>|</a>
    `;

    document.querySelector(".pagination").innerHTML = paginationHTML;
}

function goToPage(page) {
    if (page < 1 || page > totalPages) return;
    currentPage = page;

    let start = (currentPage - 1) * itemsPerPage;
    let end = start + itemsPerPage;
    let paginatedProducts = products.slice(start, end);

    renderProducts(paginatedProducts);
    renderPagination();

    document.getElementById("start").innerText = start + 1;
    document.getElementById("end").innerText = Math.min(end, products.length);
}

function renderProducts(productsToRender) {
    let productHTML = '';
    productsToRender.forEach(product => {
        if (product.sale > 0 && product.oldPrice !== "") {
            productHTML += `
                <div class="col-lg-3">
                    <div class="card product" style="width: 18rem">
                        <a href="chi-tiet-san-pham.html" onclick="viewProductDetails('${product.name}')">
                            <img src="${product.img}" class="card-img-top" alt="${product.name}" />
                        </a>
                        <div class="icon-bar">
                            <i class="fas fa-heart"></i>
                            <i class="fas fa-plus"></i>
                            <i class="fas fa-cart-shopping"></i>
                            <i class="fas fa-sync-alt"></i>
                        </div>
                        <span class="sale">${product.sale}%<br />GIẢM</span>
                        <div class="card-body">
                            <h5 class="card-title text-center product-name">${product.name}</h5>
                            <p class="card-text text-center">
                                <span class="price-new">${product.newPrice}</span>
                                <span class="price-old">${product.oldPrice}</span>
                            </p>
                            <a href="#" class="btn btn-primary" onclick="addToCart('${product.name}', ${parseInt(product.newPrice)}, '${product.img}')">ĐẶT HÀNG</a>
                        </div>
                    </div>
                </div>`;
        } else {
            productHTML += `
                <div class="col-lg-3">
                    <div class="card product" style="width: 18rem">
                        <a href="chi-tiet-san-pham.html" onclick="viewProductDetails('${product.name}')">
                            <img src="${product.img}" class="card-img-top" alt="${product.name}" />
                        </a>
                        <div class="icon-bar">
                            <i class="fas fa-heart"></i>
                            <i class="fas fa-plus"></i>
                            <i class="fas fa-cart-shopping"></i>
                            <i class="fas fa-sync-alt"></i>
                        </div>
                        <div class="card-body">
                            <h5 class="card-title text-center product-name">${product.name}</h5>
                            <p class="card-text text-center">
                                <span class="price-new">${product.newPrice}</span>
                            </p>
                            <a href="#" class="btn btn-primary" onclick="addToCart('${product.name}', ${parseInt(product.newPrice)}, '${product.img}')">ĐẶT HÀNG</a>
                        </div>
                    </div>
                </div>`;
        }
    });

    document.querySelector(".list-products").innerHTML = productHTML;
}

// Khởi tạo trang đầu tiên
goToPage(1);

// Hàm xử lý liên kết chi tiết sản phẩm
function viewProductDetails(productName) {
  localStorage.setItem("selectedProductName", productName);
}
