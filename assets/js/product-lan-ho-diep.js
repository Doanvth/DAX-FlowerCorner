let products = [
  {
    img: "https://8384f55340.vws.vegacdn.vn/image/cache/catalog/products/August%202022/chau-lan-ho-diep-012-2.jpg.webp",
    name: "Chậu Lan Hồ Điệp - 012",
    sale: 0,
    newPrice: "2950000VND",
    oldPrice: "",
  },
  {
    img: "https://8384f55340.vws.vegacdn.vn/image/cache/catalog/products/August%202022/chau-lan-ho-diep-065.jpg.webp",
    name: "Chậu Lan Hồ Điệp - 065",
    sale: 0,
    newPrice: "2750000VND",
    oldPrice: "",
  },
  {
    img: "https://8384f55340.vws.vegacdn.vn/image/cache/catalog/products/August%202022/chau-lan-ho-diep-052.jpg.webp",
    name: "Chậu Lan Hồ Điệp - 052",
    sale: 0,
    newPrice: "2420000VND",
    oldPrice: "",
  },
  {
    img: "https://8384f55340.vws.vegacdn.vn/image/cache/catalog/products/August%202022/chau-lan-ho-diep-008-02.jpg.webp",
    name: "Chậu Lan Hồ Điệp - 008",
    sale: 0,
    newPrice: "2810000VND",
    oldPrice: "",
  },
  {
    img: "https://8384f55340.vws.vegacdn.vn/image/cache/catalog/products/August%202022/chau-lan-mua-doan-vien.jpg.webp",
    name: "Mùa Đoàn Viên",
    sale: 0,
    newPrice: "8500000VND",
    oldPrice: "",
  },
  {
    img: "https://8384f55340.vws.vegacdn.vn/image/cache/catalog/products/August%202022/chau-lan-ho-diep-042.jpg.webp",
    name: "Chậu Lan Hồ Điệp - 042",
    sale: 0,
    newPrice: "5500000VND",
    oldPrice: "",
  },
  {
    img: "https://8384f55340.vws.vegacdn.vn/image/cache/catalog/products/August%202022/chau-hoa-lan-ho-diep-001.jpg.webp",
    name: "Chậu Lan Hồ Điệp - 001",
    sale: 0,
    newPrice: "4040000VND",
    oldPrice: "",
  },
  {
    img: "https://8384f55340.vws.vegacdn.vn/image/cache/catalog/products/August%202022/chau-lan-ho-diep-012.jpg.webp",
    name: "Chậu Lan Hồ Điệp Tết Phồn Thịnh",
    sale: 0,
    newPrice: "2700000VND",
    oldPrice: "",
  },
  {
    img: "https://8384f55340.vws.vegacdn.vn/image/cache/catalog/products/August%202023/ke-hoa-khai-truong-huy-hoang.jpg.webp",
    name: "Chậu Lan Hồ Điệp - 028",
    sale: 0,
    newPrice: "2870000VND",
    oldPrice: "",
  },
  {
    img: "https://8384f55340.vws.vegacdn.vn/image/cache/catalog/products/August%202022/chau-lan-ho-diep-063.jpg.webp",
    name: "Chậu Lan Hồ Điệp - 063",
    sale: 0,
    newPrice: "7000000VND",
    oldPrice: "",
  },
  {
    img: "https://8384f55340.vws.vegacdn.vn/image/cache/catalog/products/August%202023/chau-lan-ho-diep-an-thinh.jpg.webp",
    name: "Chậu lan hồ điệp An Thịnh",
    sale: 0,
    newPrice: "2350000VND",
    oldPrice: "",
  },
  {
    img: "https://8384f55340.vws.vegacdn.vn/image/cache/catalog/products/August%202023/lan-ho-diep-01.jpg.webp",
    name: "Chậu Lan Hồ Điệp Tết - 01",
    sale: 0,
    newPrice: "2780000VND",
    oldPrice: "",
  },
  {
    img: "https://8384f55340.vws.vegacdn.vn/image/cache/catalog/products/August%202023/lan-ho-diep-02.jpg.webp",
    name: "Chậu Lan Hồ Điệp Tết - 02",
    sale: 0,
    newPrice: "5,310000VND",
    oldPrice: "",
  },
  {
    img: "https://8384f55340.vws.vegacdn.vn/image/cache/catalog/products/August%202023/lan-ho-diep-06.jpg.webp",
    name: "Chậu Lan Hồ Điệp Tết - 06",
    sale: 0,
    newPrice: "2780000VND",
    oldPrice: "",
  },
  {
    img: "https://8384f55340.vws.vegacdn.vn/image/cache/catalog/products/August%202023/chau-lan-ho-diep-tet-xuan-hong.jpg.webp",
    name: "Chậu Lan Hồ Điệp Tết Xuân Hồng",
    sale: 0,
    newPrice: "1780000VND",
    oldPrice: "",
  },
  {
    img: "https://8384f55340.vws.vegacdn.vn/image/cache/catalog/products/August%202023/chau-lan-ho-diep-vuong-thinh-tet.jpg.webp",
    name: "Chậu Lan Hồ Điệp Vương Thịnh Tết",
    sale: 0,
    newPrice: "2750000VND",
    oldPrice: "",
  },
  {
    img: "https://8384f55340.vws.vegacdn.vn/image/cache/catalog/products/August%202022/chau-lan-ho-diep-005-02.jpg.webp",
    name: "Chậu Lan Hồ Điệp - 005",
    sale: 0,
    newPrice: "2750000VND",
    oldPrice: "",
  },
  {
    img: "https://8384f55340.vws.vegacdn.vn/image/cache/catalog/products/August%202023/chau-lan-ho-diep-020.jpg.webp",
    name: "Chậu Lan Hồ Điệp - 020",
    sale: 0,
    newPrice: "1760000VND",
    oldPrice: "",
  },
  {
    img: "https://8384f55340.vws.vegacdn.vn/image/cache/catalog/products/August%202023/chau-hoa-lan-ho-diep-tim-8-canh.jpg.webp",
    name: "Chậu Lan Hồ Điệp - 040",
    sale: 0,
    newPrice: "2280000VND",
    oldPrice: "",
  },
  {
    img: "https://8384f55340.vws.vegacdn.vn/image/cache/catalog/products/August%202023/chau-hoa-ho-diep-060.jpg.webp",
    name: "Chậu Lan Hồ Điệp - 060",
    sale: 0,
    newPrice: "2330000VND",
    oldPrice: "",
  },
  {
    img: "https://8384f55340.vws.vegacdn.vn/image/cache/catalog/products/August%202023/chau-lan-ho-diep-021-2.jpg.webp",
    name: "Chậu Lan Hồ Điệp - 021",
    sale: 0,
    newPrice: "2330000VND",
    oldPrice: "",
  },
  {
    img: "https://8384f55340.vws.vegacdn.vn/image/cache/catalog/products/August%202023/chau-lan-ho-diep-046-2.jpg.webp",
    name: "Chậu Lan Hồ Điệp - 046",
    sale: 0,
    newPrice: "2280000VND",
    oldPrice: "",
  },
  {
    img: "https://8384f55340.vws.vegacdn.vn/image/cache/catalog/products/August%202023/chau-lan-ho-diep-048-03.jpg.webp",
    name: "Chậu Lan Hồ Điệp - 048",
    sale: 0,
    newPrice: "2330000VND",
    oldPrice: "",
  },
  {
    img: "https://8384f55340.vws.vegacdn.vn/image/cache/catalog/products/August%202023/chau-lan-ho-diep-xuan-huong-tet.jpg.webp",
    name: "Chậu Lan Hồ Điệp Tết - Hương Xuân",
    sale: 0,
    newPrice: "2300000VND",
    oldPrice: "",
  },
];

const itemsPerPage = 8; // Số sản phẩm mỗi trang
const totalProducts = products.length;
const totalPages = Math.ceil(totalProducts / itemsPerPage);
let currentPage = 1;

function renderProducts(page) {
  const startIndex = (page - 1) * itemsPerPage;
  const endIndex = Math.min(startIndex + itemsPerPage, totalProducts);
  
  let p = "";
  for (let i = startIndex; i < endIndex; i++) {
    if (products[i].sale > 0 && products[i].oldPrice !== "") {
      p += `
        <div class="col-lg-3">
            <div class="card product" style="width: 18rem">
                <a href="chi-tiet-san-pham.html" onclick="viewProductDetails('${products[i].name}')">
                    <img src="${products[i].img}" class="card-img-top" alt="${products[i].name}" />
                </a>
                <div class="icon-bar">
                    <i class="fas fa-heart"></i>
                    <i class="fas fa-plus"></i>
                    <i class="fas fa-cart-shopping"></i>
                    <i class="fas fa-sync-alt"></i>
                </div>
                <span class="sale">${products[i].sale}%<br />GIẢM</span>
                <div class="card-body">
                    <h5 class="card-title text-center product-name">${products[i].name}</h5>
                    <p class="card-text text-center">
                        <span class="price-new">${products[i].newPrice}</span>
                        <span class="price-old">${products[i].oldPrice}</span>
                    </p>
                    <a href="#" class="btn btn-primary" onclick="addToCart('${products[i].name}', ${parseInt(products[i].newPrice)}, '${products[i].img}')">ĐẶT HÀNG</a>
                </div>
            </div>
        </div>`;
    } else if (products[i].sale == 0 && products[i].oldPrice == "") {
      p += `
        <div class="col-lg-3">
            <div class="card product" style="width: 18rem">
                <a href="chi-tiet-san-pham.html" onclick="viewProductDetails('${products[i].name}')">
                    <img src="${products[i].img}" class="card-img-top" alt="${products[i].name}" />
                </a>
                <div class="icon-bar">
                    <i class="fas fa-heart"></i>
                    <i class="fas fa-plus"></i>
                    <i class="fas fa-cart-shopping"></i>
                    <i class="fas fa-sync-alt"></i>
                </div>
                <div class="card-body">
                    <h5 class="card-title text-center product-name">${products[i].name}</h5>
                    <p class="card-text text-center">
                        <span class="price-new">${products[i].newPrice}</span>
                    </p>
                    <a href="#" class="btn btn-primary" onclick="addToCart('${products[i].name}', ${parseInt(products[i].newPrice)}, '${products[i].img}')">ĐẶT HÀNG</a>
                </div>
            </div>
        </div>`;
    }
  }

  document.querySelector(".list-products").innerHTML = p;
  updatePagination();
  updateQuantityInfo();
}

function updatePagination() {
  const pagination = document.querySelector(".pagination");
  pagination.innerHTML = "";

  if (currentPage > 1) {
    pagination.innerHTML += `<a href="#" onclick="changePage(1)">|&lt;</a>`;
    pagination.innerHTML += `<a href="#" onclick="changePage(${currentPage - 1})">&lt;</a>`;
  }

  for (let i = 1; i <= totalPages; i++) {
    pagination.innerHTML += `
      <a href="#" class="${i === currentPage ? 'active' : ''}" onclick="changePage(${i})">${i}</a>
    `;
  }

  if (currentPage < totalPages) {
    pagination.innerHTML += `<a href="#" onclick="changePage(${currentPage + 1})">&gt;</a>`;
    pagination.innerHTML += `<a href="#" onclick="changePage(${totalPages})">&gt;|</a>`;
  }
}

function updateQuantityInfo() {
  document.querySelector(".quantity-products").innerHTML = `Hiển thị từ ${(currentPage - 1) * itemsPerPage + 1} đến ${Math.min(currentPage * itemsPerPage, totalProducts)} / ${totalProducts} (${totalPages} Trang)`;
}

function changePage(page) {
  if (page < 1 || page > totalPages) return;
  currentPage = page;
  renderProducts(currentPage);
}

// Khởi động trang đầu tiên
renderProducts(currentPage);

// Hàm xử lý liên kết chi tiết sản phẩm
function viewProductDetails(productName) {
  localStorage.setItem("selectedProductName", productName);
}
